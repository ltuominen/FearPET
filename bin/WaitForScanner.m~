function TrialStruct = WaitForScanner( TrialStruct )
% Convenience function to sync experiment with fMRI scanner. Waits to
% receive signal (5) from scanner.

%% Place 'Waiting for scanner...' text on screen. Wait.
WaitText = 'Waiting for scanner...';
Screen('TextFont', TrialStruct.MainWindow, 'Helvetica');
Screen('TextSize', TrialStruct.MainWindow, 24);
DrawFormattedText(TrialStruct.MainWindow, WaitText, 'center', 'center',...
                  [255 255 255], 60);
Screen('Flip',TrialStruct.MainWindow);

% Sample from keyboard. Wait for equals sign. Record start time.
devIdx = 6 % 
[a,b,c]=GetKeyboardIndices(); 
devIdx = find(strfind(b, 'Current Designs, Inc. 932')
KbQueueCreate(devIdx);    
KbQueueStart(devIdx);
KbQueueFlush(devIdx);
TrialStruct.StartTime=KbQueueWait(devIdx, 0);

end